---
title: "Paper finale"
output: html_document
---

```{r}
data <- read.csv("dataset.csv")
data.ita <- subset(data, select = c("d1", "d1r2", "dx2", "dx4", "d13", "dx21", "d12it_r", "q1_1", "q1_3", "q1_5", "q1_6", "q2_2", "q3_2", "q1_4"), subset = data$isocntry == "IT")

data.ita$d12it_r <- factor(data.ita$d12it_r, levels = 1:5, labels = c("NO", "NE", "CE", "SUD", "IS"))

colnames(data.ita)[1:14] <- c("age", "age_class", "sex", "education", "residence", "partner", "region", "q1_1", "q1_2", "q2_1", "q2_2", "q3_1", "q3_2", "q3_3")

data.ita$sex[data.ita$sex == 999] <- NA
data.ita$sex <- factor(data.ita$sex, levels = c(1, 2), labels = c("male", "female"))

data.ita$residence[data.ita$residence == 998] <- NA
data.ita$residence <- factor(data.ita$residence, levels = c(1, 2, 3), labels = c("village", "town", "city"))

data.ita$partner[data.ita$prtner == (999|998)] <- NA
data.ita$partner <- factor(data.ita$partner, levels = c(1, 2), labels = c("yes", "no"))


data.ita$q1_1[data.ita$q1_1 == 998] <- NA
data.ita$q1_2[data.ita$q1_2 == 998] <- NA
data.ita$q2_1[data.ita$q2_1 == 998] <- NA
data.ita$q2_2[data.ita$q2_2 == 998] <- NA
data.ita$q3_1[data.ita$q3_1 == 998] <- NA
data.ita$q3_2[data.ita$q3_2 == 998] <- NA
data.ita$q3_3[data.ita$q3_3 == 998] <- NA


```


```{r}
# percezione di genere: domande q1_1, q1_2

mean_q1_1 <- mean(data.ita$q1_1, na.rm = TRUE)
mean_q1_1

mean_q1_2 <- mean(data.ita$q1_2, na.rm = TRUE)
mean_q1_2

mean(c(mean_q1_1, mean_q1_2))


barplot(prop.table(table(data.ita$q1_1)))
#sistemare assi, etichette, titolo ecc

barplot(prop.table(table(data.ita$q1_2)))
#sistemare assi, etichette, titolo ecc




prop.table(table(data.ita$sex, data.ita$q1_1), 1)
prop.table(table(data.ita$sex, data.ita$q1_2), 1)

barplot(prop.table(table(data.ita$sex, data.ita$q1_1), 1), beside = TRUE)
barplot(prop.table(table(data.ita$sex, data.ita$q1_2), 1), beside = TRUE)




barplot(prop.table(table(data.ita$q1_1, data.ita$age_class)), beside = TRUE) # trovare le proporzioni all'interno della classe d'etÃ 

prop.table(table(data.ita$age_class))



tapply(data.ita$q1_1, data.ita$region, mean, na.rm = TRUE) # quindi si possono paccare ulteriori indagini geografiche?!

tapply(data.ita$q1_1, data.ita$residence, mean, na.rm = TRUE)
tapply(data.ita$q1_1, data.ita$partner, mean, na.rm = TRUE)


```